<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Write Reflection</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
<meta name="theme-color" content="#0d6efd">

  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->
</head>
<body>


  <header id="main-header"></header>


<main>
  <section class="game-section">
    <textarea type="text" id="reflectionName" rows="1" placeholder="Name"></textarea>
    <textarea id="reflectionText" rows="6" placeholder="Write your thoughts..."></textarea>

    <div class="buttons">
      <button id="saveReflection">Save Reflection</button>
    </div>
  </section>
</main>
 <footer id="main-footer"></footer>

 <script src="{{ url_for('static', filename='js/script.js') }}"></script>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script>
document.getElementById("saveReflection").onclick = () => {
    const text = document.getElementById("reflectionText").value;
    const name = document.getElementById("reflectionName").value;

    fetch("/api/add_reflection", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ text, name })
    })
    .then(res => res.json())
    .then(data => {
        if(data.error){
            alert(data.error);
            return;
        }
        alert(data.message);
        const div = document.createElement("div");
        div.className = "reflection-card";
        div.innerHTML = `<strong>${data.entry.name}</strong><br>${data.entry.text}`;
        document.querySelector("section.game-section").appendChild(div);
        document.getElementById("reflectionText").value = "";
        document.getElementById("reflectionName").value = "";
    })
    .catch(err => {
        alert("Error saving reflection. You might be offline.");
        console.error(err);
    });
};
</script>



</body>
</html>
